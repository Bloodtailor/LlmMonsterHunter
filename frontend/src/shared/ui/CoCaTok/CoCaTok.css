/* CoCaTok (Collectable Card Tokens) - Interactive 3D spinning collectible cards */
/* Always spinning, bouncing cards that explode dramatically and disappear forever */

/* ===== COCATOK FOUNDATION ===== */

.cocatok {
  perspective: 1000px;
  display: inline-block;
  cursor: pointer;
  transition: transform var(--transition-fast);
  position: relative;
}

/* Card bouncing - stops when exploding */
.cocatok:not(.cocatok-exploding) {
  animation: cardBounce 4s ease-in-out infinite;
}

/* Card bouncing animation */
@keyframes cardBounce {
  0%, 100% { 
    transform: translateY(0px) scale(1); 
  }
  50% { 
    transform: translateY(-6px) scale(1); 
  }
}

/* Whole card fades out after explosion */
.cocatok-exploding {
  animation: cardDisappear 1s ease-out forwards;
}

@keyframes cardDisappear {
  0% { 
    opacity: 1; 
  }
  70% { 
    opacity: 1; 
  }
  100% { 
    opacity: 0; 
  }
}

.cocatok:hover:not(.cocatok-disabled):not(.cocatok-spinning):not(.cocatok-exploding) {
  animation: hoverEffect 0.6s ease-out forwards; /* Smooth lift that matches turn-around */
}

.cocatok:active:not(.cocatok-disabled):not(.cocatok-spinning) {
  transform: translateY(-6px) scale(0.95);
}

/* Smooth hover effect - lift and scale together */
@keyframes hoverEffect {
  0% { 
    transform: translateY(0px) scale(1); 
  }
  100% { 
    transform: translateY(-6px) scale(1.05); 
  }
}

.cocatok-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform var(--transition-normal); /* Smooth animation for hover */
}

/* Default gentle spinning animation - always active unless spinning fast, hovering, or exploding */
.cocatok:not(.cocatok-spinning):not(:hover):not(.cocatok-exploding) .cocatok-inner {
  animation: gentleSpin 4s linear infinite;
}

/* On hover - instantly face away, then quickly turn to face forward */
.cocatok:hover:not(.cocatok-spinning):not(.cocatok-exploding) .cocatok-inner {
  animation: turnToFaceYou 0.6s ease-out forwards;
}

@keyframes turnToFaceYou {
  0% { 
    transform: rotateY(180deg); /* Start facing away */
  }
  100% { 
    transform: rotateY(0deg); /* Turn to face you */
  }
}

@keyframes gentleSpin {
  0% { transform: rotateY(0deg); }
  100% { transform: rotateY(360deg); }
}

/* ===== CARD FACES ===== */

.cocatok-front,
.cocatok-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: var(--radius-lg);
  border: 1px solid;
  padding: 0.3em;
  box-sizing: border-box;
}

.cocatok-front {
  display: flex;
  flex-direction: column;
  gap: 0.2em;
}

.cocatok-back {
  transform: rotateY(180deg);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== CARD FRONT ELEMENTS ===== */

.card-image-area {
  width: 100%;
  height: 50%;
  background: var(--color-surface-elevated);
  border-radius: var(--radius-sm);
  opacity: 0.7;
  position: relative; /* Allow emoji to be positioned inside */
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-title-line {
  width: 80%;
  height: 0.4em;
  background: currentColor;
  border-radius: var(--radius-sm);
  opacity: 0.6;
}

.card-text-line {
  width: 100%;
  height: 0.25em;
  background: currentColor;
  border-radius: var(--radius-sm);
  opacity: 0.4;
}

.card-text-line.short {
  width: 60%;
}

/* ===== CARD BACK ELEMENTS ===== */

.cocatok-emoji {
  font-size: 1.5em;
  z-index: 2;
  position: relative;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  /* No animation - back emoji stays still */
}

/* Front emoji - lower opacity, positioned inside card image area, bounces */
.front-emoji {
  font-size: 1.2em;
  opacity: 0.4; /* Slightly more visible since it's inside the darker image area */
  z-index: 3;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
  animation: frontEmojiBounce 3s ease-in-out infinite;
}

@keyframes frontEmojiBounce {
  0%, 100% { 
    transform: translateY(0px); 
  }
  50% { 
    transform: translateY(-8px); 
  }
}

/* ===== SIZE VARIANTS ===== */
/* New sizing: what was lg is now sm, and scale up from there */

.cocatok-sm { 
  width: 3.5em; 
  height: 4.7em;
  font-size: 20px;
}

.cocatok-sm .cocatok-emoji {
  font-size: 1.8em;
}

.cocatok-sm .front-emoji {
  font-size: 1.4em;
}

.cocatok-md { 
  width: 4.5em; 
  height: 6em;
  font-size: 24px;
}

.cocatok-md .cocatok-emoji {
  font-size: 2.2em;
}

.cocatok-md .front-emoji {
  font-size: 1.8em;
}

.cocatok-lg { 
  width: 5.5em; 
  height: 7.3em;
  font-size: 28px;
}

.cocatok-lg .cocatok-emoji {
  font-size: 2.6em;
}

.cocatok-lg .front-emoji {
  font-size: 2.2em;
}

.cocatok-xl { 
  width: 6.5em; 
  height: 8.7em;
  font-size: 32px;
}

.cocatok-xl .cocatok-emoji {
  font-size: 3em;
}

.cocatok-xl .front-emoji {
  font-size: 2.6em;
}

/* ===== FAST SPINNING ANIMATION (when clicked) ===== */

.cocatok-spinning .cocatok-inner {
  animation: fastSpin 3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

@keyframes fastSpin {
  0% { 
    transform: rotateY(0deg); 
  }
  60% { 
    transform: rotateY(1800deg); /* Fast spin - 5 full rotations */
  }
  100% { 
    transform: rotateY(1800deg); /* Stop facing forward */
  }
}

/* Scale effect during explosion + card fade out */
.cocatok-exploding .cocatok-inner {
  animation: explodeAndDisappear 1s ease-out forwards;
}

@keyframes explodeAndDisappear {
  0% { 
    transform: rotateY(1800deg) scale(1); 
    opacity: 1;
  }
  30% { 
    transform: rotateY(1800deg) scale(1.3); 
    opacity: 1;
  }
  60% { 
    transform: rotateY(1800deg) scale(1.1); 
    opacity: 1;
  }
  100% { 
    transform: rotateY(1800deg) scale(0.8); 
    opacity: 0; /* Card disappears forever */
  }
}

/* Make emojis disappear during explosion */
.cocatok-exploding .front-emoji {
  animation: frontEmojiDisappear 1s ease-out forwards;
}

.cocatok-exploding .cocatok-emoji {
  animation: emojiDisappear 1s ease-out forwards;
}

@keyframes explodeScale {
  0% { transform: rotateY(1800deg) scale(1); }
  50% { transform: rotateY(1800deg) scale(1.2); }
  100% { transform: rotateY(1800deg) scale(1); }
}

@keyframes frontEmojiDisappear {
  0% { 
    opacity: 0.4; 
    transform: scale(1); 
  }
  100% { 
    opacity: 0; 
    transform: scale(0); 
  }
}

@keyframes emojiDisappear {
  0% { 
    opacity: 1; 
    transform: scale(1); 
  }
  100% { 
    opacity: 0; 
    transform: scale(0); 
  }
}

/* ===== DISABLED STATE ===== */

.cocatok-disabled {
  opacity: var(--opacity-disabled);
  cursor: not-allowed;
  filter: grayscale(0.5);
  animation: none; /* No bouncing when disabled */
}

.cocatok-disabled:hover {
  transform: none;
  animation: none;
}

.cocatok-disabled .cocatok-inner {
  animation: none;
}

.cocatok-disabled .front-emoji {
  animation: none;
}

/* ===== ACCESSIBILITY ===== */

@media (prefers-reduced-motion: reduce) {
  .cocatok,
  .cocatok-inner,
  .front-emoji {
    animation: none !important;
  }
  
  .cocatok:hover:not(.cocatok-spinning) .cocatok-inner {
    transform: rotateY(0deg);
  }
  
  .cocatok-spinning .cocatok-inner {
    transform: rotateY(180deg);
  }
  
  .cocatok-exploding .cocatok-inner {
    transform: rotateY(180deg) scale(1.1);
  }
  
  .cocatok-exploding .cocatok-emoji,
  .cocatok-exploding .front-emoji {
    opacity: 0;
  }
}